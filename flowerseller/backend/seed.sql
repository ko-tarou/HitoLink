-- Flower Seller デモデータ（schema 適用後に実行）
-- 実行例（Docker の Postgres が 5433 の場合）:
--   プロジェクトルートで: docker-compose exec -T postgres psql -U flowerseller -d flowerseller < backend/seed.sql

-- デモ用ユーザー（価格調整履歴の created_by 用。パスワードは "demo"）
INSERT INTO users (id, email, password_hash, role, display_name) VALUES
  ('a0000000-0000-0000-0000-000000000001', 'demo@flowerseller.local', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy', 'admin', 'デモ')
ON CONFLICT (id) DO NOTHING;

-- カテゴリ
INSERT INTO categories (id, name, sort_order) VALUES
  ('b0000000-0000-0000-0000-000000000001', '切り花', 1),
  ('b0000000-0000-0000-0000-000000000002', '束', 2),
  ('b0000000-0000-0000-0000-000000000003', 'アレンジ', 3)
ON CONFLICT (id) DO NOTHING;

-- 商品（単品・束・アレンジ）
INSERT INTO products (id, name, type, category_id, base_price, description, disposal_days) VALUES
  ('c0000000-0000-0000-0000-000000000001', 'バラ（赤）', 'single', 'b0000000-0000-0000-0000-000000000001', 350, '春っぽい赤い花', 7),
  ('c0000000-0000-0000-0000-000000000002', 'チューリップ', 'single', 'b0000000-0000-0000-0000-000000000001', 200, '春の花', 5),
  ('c0000000-0000-0000-0000-000000000003', 'ガーベラ', 'single', 'b0000000-0000-0000-0000-000000000001', 180, '明るい色の花', 7),
  ('c0000000-0000-0000-0000-000000000004', 'バラ10本束', 'bundle', 'b0000000-0000-0000-0000-000000000002', 3000, '赤バラ10本の束', 7),
  ('c0000000-0000-0000-0000-000000000005', '春のブーケ', 'arrangement', 'b0000000-0000-0000-0000-000000000003', 5000, '春の花のアレンジメント', 5)
ON CONFLICT (id) DO NOTHING;

-- 在庫バッチ（入荷サンプル）※ seed は初回1回だけ実行推奨
INSERT INTO inventory_batches (product_id, quantity, disposal_date) VALUES
  ('c0000000-0000-0000-0000-000000000001', 50, CURRENT_DATE + 7),
  ('c0000000-0000-0000-0000-000000000002', 30, CURRENT_DATE + 5),
  ('c0000000-0000-0000-0000-000000000004', 10, CURRENT_DATE + 7);

-- 水やりデモデータ（上で入れた在庫バッチのうち先頭2件に次回水やりを設定）
INSERT INTO watering_records (inventory_batch_id, next_watering_at)
SELECT id, now() + interval '1 day' FROM inventory_batches ORDER BY created_at DESC LIMIT 2;

-- 売上デモデータ（直近7日分の日別売上）※再実行時は既存デモを削除してから挿入
DELETE FROM sale_items WHERE sale_id IN (SELECT id FROM sales WHERE id::text LIKE 'd0000000-%');
DELETE FROM sales WHERE id::text LIKE 'd0000000-%';
INSERT INTO sales (id, total_amount, payment_method, created_by, created_at) VALUES
  ('d0000000-0000-0000-0000-000000000001', 1850, 'cash', 'a0000000-0000-0000-0000-000000000001', now() - interval '6 days'),
  ('d0000000-0000-0000-0000-000000000002', 3200, 'credit', 'a0000000-0000-0000-0000-000000000001', now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000003', 500, 'paypay', 'a0000000-0000-0000-0000-000000000001', now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000004', 5180, 'cash', 'a0000000-0000-0000-0000-000000000001', now() - interval '4 days'),
  ('d0000000-0000-0000-0000-000000000005', 700, 'credit', 'a0000000-0000-0000-0000-000000000001', now() - interval '3 days'),
  ('d0000000-0000-0000-0000-000000000006', 3000, 'cash', 'a0000000-0000-0000-0000-000000000001', now() - interval '2 days'),
  ('d0000000-0000-0000-0000-000000000007', 2350, 'paypay', 'a0000000-0000-0000-0000-000000000001', now() - interval '1 day'),
  ('d0000000-0000-0000-0000-000000000008', 1200, 'cash', 'a0000000-0000-0000-0000-000000000001', now())
ON CONFLICT (id) DO NOTHING;

INSERT INTO sale_items (sale_id, product_id, quantity, unit_price, subtotal, created_at) VALUES
  ('d0000000-0000-0000-0000-000000000001', 'c0000000-0000-0000-0000-000000000001', 2, 350, 700, now() - interval '6 days'),
  ('d0000000-0000-0000-0000-000000000001', 'c0000000-0000-0000-0000-000000000002', 3, 200, 600, now() - interval '6 days'),
  ('d0000000-0000-0000-0000-000000000001', 'c0000000-0000-0000-0000-000000000003', 2, 180, 360, now() - interval '6 days'),
  ('d0000000-0000-0000-0000-000000000002', 'c0000000-0000-0000-0000-000000000004', 1, 3000, 3000, now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000002', 'c0000000-0000-0000-0000-000000000001', 1, 350, 350, now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000003', 'c0000000-0000-0000-0000-000000000002', 2, 200, 400, now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000003', 'c0000000-0000-0000-0000-000000000003', 1, 180, 180, now() - interval '5 days'),
  ('d0000000-0000-0000-0000-000000000004', 'c0000000-0000-0000-0000-000000000005', 1, 5000, 5000, now() - interval '4 days'),
  ('d0000000-0000-0000-0000-000000000004', 'c0000000-0000-0000-0000-000000000001', 1, 350, 350, now() - interval '4 days'),
  ('d0000000-0000-0000-0000-000000000005', 'c0000000-0000-0000-0000-000000000002', 2, 200, 400, now() - interval '3 days'),
  ('d0000000-0000-0000-0000-000000000005', 'c0000000-0000-0000-0000-000000000003', 2, 180, 360, now() - interval '3 days'),
  ('d0000000-0000-0000-0000-000000000006', 'c0000000-0000-0000-0000-000000000004', 1, 3000, 3000, now() - interval '2 days'),
  ('d0000000-0000-0000-0000-000000000007', 'c0000000-0000-0000-0000-000000000004', 1, 3000, 3000, now() - interval '1 day'),
  ('d0000000-0000-0000-0000-000000000007', 'c0000000-0000-0000-0000-000000000001', 1, 350, 350, now() - interval '1 day'),
  ('d0000000-0000-0000-0000-000000000008', 'c0000000-0000-0000-0000-000000000002', 3, 200, 600, now()),
  ('d0000000-0000-0000-0000-000000000008', 'c0000000-0000-0000-0000-000000000003', 2, 180, 360, now());
